{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Security scan threshold configuration for Securing Ralph Loop",

  "semgrep": {
    "enabled": true,
    "failOn": {
      "error": true,
      "warning": false,
      "info": false
    },
    "maxFindings": {
      "error": 0,
      "warning": 10,
      "info": -1
    },
    "ignoredRules": [],
    "ignoredPaths": [
      "**/test/**",
      "**/tests/**",
      "**/*.test.*",
      "**/*.spec.*",
      "**/node_modules/**",
      "**/venv/**",
      "**/.venv/**"
    ]
  },

  "snyk": {
    "enabled": true,
    "severityThreshold": "medium",
    "failOn": {
      "critical": true,
      "high": true,
      "medium": false,
      "low": false
    },
    "maxVulnerabilities": {
      "critical": 0,
      "high": 0,
      "medium": 5,
      "low": -1
    },
    "ignoredVulnerabilities": []
  },

  "remediation": {
    "maxRetries": 3,
    "rollbackOnFailure": true,
    "escalateAfterRetries": true
  },

  "iteration": {
    "maxIterations": 10,
    "timeoutSeconds": 3600,
    "pauseBetweenIterations": 5
  },

  "audit": {
    "enabled": true,
    "logPath": "state/security-audit.jsonl",
    "retentionDays": 30,
    "includeToolOutput": true
  },

  "notifications": {
    "slack": {
      "enabled": false,
      "webhookEnvVar": "RALPH_SLACK_WEBHOOK",
      "notifyOn": ["escalation", "completion", "failure"]
    },
    "github": {
      "enabled": false,
      "createIssueOnEscalation": false,
      "labels": ["security", "automated", "ralph-loop"]
    }
  },

  "baseline": {
    "enabled": true,
    "create_security_issues": true,
    "issue_labels": ["security-debt", "ralph-detected"],
    "dedup_by_file": true
  }
}
